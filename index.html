<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Penny AI - by Archaigel</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { --blue: #3498db; --yellow: #f1c40f; --green: #2ecc71; --dark: #2c3e50; --bg: #fdfaf6; --white: #ffffff; }
        html, body { height: 100%; margin: 0; padding: 0; background: var(--bg); font-family: 'Segoe UI', sans-serif; overflow: hidden; }
        .app-container { width: 100%; max-width: 500px; height: 100vh; margin: 0 auto; background: var(--white); display: flex; flex-direction: column; padding: 15px; box-sizing: border-box; overflow-y: auto; }
        
        header { text-align: center; margin-bottom: 10px; flex-shrink: 0; position: relative; padding-top: 35px; }
        .header-tools { position: absolute; top: 0; right: 0; display: flex; gap: 8px; align-items: center; }
        .lang-select { padding: 4px; border-radius: 8px; border: 1px solid #ddd; font-size: 12px; width: 65px; background: #fff; }
        .help-icon { background: var(--dark); color: white; border-radius: 50%; width: 28px; height: 28px; display: flex; align-items: center; justify-content: center; cursor: pointer; font-weight: bold; font-size: 16px; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
        
        .total-box { background: #f8f9fa; border-radius: 12px; padding: 15px; text-align: center; margin-bottom: 15px; border: 1px dashed #ccc; }
        .total-amount { font-size: 32px; font-weight: bold; color: var(--dark); }
        
        .dashboard { display: flex; justify-content: space-around; margin-bottom: 10px; }
        .circle { width: 75px; height: 75px; border-radius: 50%; display: flex; flex-direction: column; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 11px; }
        .needs { background: var(--blue); } .wants { background: var(--yellow); } .future { background: var(--green); }
        
        /* Modal - Professional Mission Layout */
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); backdrop-filter: blur(3px); }
        .modal-content { background: white; margin: 5% auto; padding: 25px; border-radius: 20px; width: 85%; max-height: 80vh; overflow-y: auto; position: relative; box-shadow: 0 5px 25px rgba(0,0,0,0.3); }
        .close-modal { position: sticky; top: -10px; float: right; background: white; border-radius: 50%; width: 30px; height: 30px; text-align: center; font-size: 24px; cursor: pointer; line-height: 30px; font-weight: bold; }
        .modal h2 { color: var(--dark); margin-top: 0; }
        .modal h3 { border-bottom: 2px solid var(--blue); display: inline-block; margin-bottom: 10px; }
        .modal p, .modal li { font-size: 14px; line-height: 1.5; color: #444; }

        input, select { width: 100%; padding: 12px; margin-bottom: 10px; border-radius: 10px; border: 1px solid #ddd; font-size: 16px; background: #fafafa; }
        .btn { width: 100%; padding: 16px; border: none; border-radius: 12px; background: var(--dark); color: white; font-weight: bold; cursor: pointer; font-size: 16px; }
        .history-item { display: flex; justify-content: space-between; align-items: center; padding: 10px 0; border-bottom: 1px solid #f0f0f0; }
        .delete-btn { background: #fee2e2; color: #ef4444; border: none; border-radius: 6px; padding: 6px 12px; font-size: 12px; cursor: pointer; }
        
        footer { padding: 15px 0; text-align: center; font-size: 11px; color: #95a5a6; border-top: 1px solid #eee; margin-top: auto; }
        #chartCanvas { position: absolute; left: -9999px; top: -9999px; }
    </style>
</head>
<body>

<div class="app-container">
    <header>
        <div class="header-tools">
            <div class="help-icon" onclick="toggleModal(true)">?</div>
            <select class="lang-select" id="lang-picker" onchange="changeLanguage()">
                <option value="en">EN üá∫üá∏</option>
                <option value="fr">FR üá´üá∑</option>
                <option value="es">ES üá™üá∏</option>
            </select>
        </div>
        <div style="font-size: 24px; font-weight: bold;">Penny AI ü™ô</div>
        <small>Designed by <strong>Archaigel</strong></small>
    </header>

    <div id="helpModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="toggleModal(false)">&times;</span>
            <div id="modal-text">
                <h2>Penny AI ü™ô</h2>
                <p>Designed by <strong>Archaigel (AKT Group LLC)</strong></p>
                <p>Penny AI is a financial discipline tool designed for middle-class families and small business owners. It is built to support the <strong>Community Shield 2026</strong> initiative‚Äîa mission to ensure that "No Family is Left Behind."</p>
                
                <h3>üõ°Ô∏è The Mission</h3>
                <p>Our goal is to stop the "GoFundMe cycle" by educating 1,000 families across 25 states. We focus on:</p>
                <ul>
                    <li><strong>Protection:</strong> Using Life Insurance as a foundation.</li>
                    <li><strong>Accumulation:</strong> Building tax-free wealth.</li>
                    <li><strong>Legacy:</strong> Will and Trust planning for the future.</li>
                </ul>

                <h3>üõ†Ô∏è Features</h3>
                <ul>
                    <li><strong>50/30/20 Strategy:</strong> Automated tracking for Needs, Wants, and Future savings.</li>
                    <li><strong>Trilingual Support:</strong> Available in English, French, and Spanish.</li>
                    <li><strong>Visual Reporting:</strong> Generates professional PDF reports with spending graphs.</li>
                    <li><strong>Privacy First:</strong> All data stays locally on your device.</li>
                </ul>

                <h3>üöÄ How to Use</h3>
                <ol>
                    <li>Enter your Monthly Income.</li>
                    <li>Log your daily expenses with a date and description.</li>
                    <li>Review your "Recent History" and delete any mistakes.</li>
                    <li>Download your Monthly Report to track your progress.</li>
                </ol>
                <p style="text-align: center; font-weight: bold; margin-top: 20px;">‚ÄúEducating our communities today for a secure tomorrow.‚Äù ‚Äî Archaigel</p>
            </div>
        </div>
    </div>

    <div class="total-box">
        <small id="lbl-bal">Balance Remaining</small>
        <div class="total-amount" id="total-val">$0</div>
    </div>

    <div class="dashboard">
        <div style="text-align: center;"><div class="circle needs" id="needs-val">$0</div><small id="lbl-n" style="display:block; margin-top:5px; font-weight:600;">Needs 50%</small></div>
        <div style="text-align: center;"><div class="circle wants" id="wants-val">$0</div><small id="lbl-w" style="display:block; margin-top:5px; font-weight:600;">Want 30%</small></div>
        <div style="text-align: center;"><div class="circle future" id="future-val">$0</div><small id="lbl-f" style="display:block; margin-top:5px; font-weight:600;">Future 20%</small></div>
    </div>

    <div id="setup-ui">
        <input type="number" id="monthly-income" placeholder="Monthly Income ($)" inputmode="decimal">
        <button class="btn" id="btn-start" onclick="initBudget()">Start Wealth Plan</button>
    </div>

    <div id="action-ui" style="display:none;">
        <input type="date" id="exp-date">
        <input type="text" id="exp-desc" placeholder="Description">
        <input type="number" id="exp-amt" placeholder="Amount ($)" inputmode="decimal">
        <select id="exp-cat">
            <option value="needs" id="opt-n">Needs 50% (Housing, Food, Utilities)</option>
            <option value="wants" id="opt-w">Want 30% (Entertainment, Dining out)</option>
            <option value="future" id="opt-f">Future 20% (Life Insurance & Savings)</option>
        </select>
        <button class="btn" id="btn-add" onclick="addExpense()">Add Expense</button>
        <button class="btn" id="btn-rep" style="background: var(--green); margin-top: 8px;" onclick="showReportUI()">Finish & Report</button>
        
        <div id="history-section">
            <div style="font-weight: bold; margin-bottom: 10px;" id="lbl-hist">Recent History</div>
            <div id="history-list"></div>
        </div>
    </div>

    <div id="report-ui" style="display:none;">
        <input type="date" id="rep-start">
        <input type="date" id="rep-end" style="margin-top: 5px;">
        <button class="btn" id="btn-pdf" style="margin-top: 15px;" onclick="generatePDF()">Download Report</button>
        <button class="btn" id="btn-res" style="background: #eee; color: #333; margin-top: 8px;" onclick="location.reload()">Reset</button>
    </div>

    <footer>
        <strong>Archaigel</strong> | Financial Architect<br>
        <span id="lbl-priv">Your information stays on your device</span>
    </footer>
</div>

<canvas id="chartCanvas" width="400" height="400"></canvas>

<script>
    let expenses = [];
    let budget = { needs: 0, wants: 0, future: 0, totalIncome: 0 };
    let currentLang = 'en';
    document.getElementById('exp-date').valueAsDate = new Date();

    const trans = {
        en: { bal: "Balance Remaining", n: "Needs 50%", w: "Want 30%", f: "Future 20%", start: "Start Wealth Plan", add: "Add Expense", rep: "Finish & Report", hist: "Recent History", priv: "Your information stays on your device", del: "Delete" },
        fr: { bal: "Solde Restant", n: "Besoins 50%", w: "Envies 30%", f: "Futur 20%", start: "D√©marrer le plan", add: "Enregistrer", rep: "Terminer & Rapport", hist: "Historique r√©cent", priv: "Vos informations restent sur votre appareil", del: "Suppr" },
        es: { bal: "Saldo Restante", n: "Necesidades 50%", w: "Deseos 30%", f: "Futuro 20%", start: "Iniciar Plan", add: "Registrar Gasto", rep: "Finalizar y Reporte", hist: "Historial Reciente", priv: "Su informaci√≥n permanece en su dispositivo", del: "Borrar" }
    };

    function toggleModal(show) {
        document.getElementById('helpModal').style.display = show ? 'block' : 'none';
    }

    function changeLanguage() {
        currentLang = document.getElementById('lang-picker').value;
        const t = trans[currentLang];
        document.getElementById('lbl-bal').innerText = t.bal;
        document.getElementById('lbl-n').innerText = t.n;
        document.getElementById('lbl-w').innerText = t.w;
        document.getElementById('lbl-f').innerText = t.f;
        document.getElementById('btn-start').innerText = t.start;
        document.getElementById('btn-add').innerText = t.add;
        document.getElementById('btn-rep').innerText = t.rep;
        document.getElementById('lbl-hist').innerText = t.hist;
        document.getElementById('lbl-priv').innerText = t.priv;
        updateHistory();
    }

    function initBudget() {
        const inc = document.getElementById('monthly-income').value;
        if (inc <= 0) return;
        budget.totalIncome = parseFloat(inc);
        budget.needs = inc * 0.5; budget.wants = inc * 0.3; budget.future = inc * 0.2;
        document.getElementById('setup-ui').style.display = 'none';
        document.getElementById('action-ui').style.display = 'block';
        updateUI();
    }

    function addExpense() {
        const d = document.getElementById('exp-date').value;
        const s = document.getElementById('exp-desc').value;
        const a = parseFloat(document.getElementById('exp-amt').value);
        const c = document.getElementById('exp-cat').value;
        if (!d || !s || isNaN(a)) return;
        budget[c] -= a;
        expenses.push({ id: Date.now(), date: d, desc: s, amt: a, cat: c });
        expenses.sort((a, b) => new Date(b.date) - new Date(a.date));
        updateUI(); updateHistory();
        document.getElementById('exp-desc').value = '';
        document.getElementById('exp-amt').value = '';
    }

    function deleteExpense(id) {
        const i = expenses.findIndex(e => e.id === id);
        if (i > -1) {
            budget[expenses[i].cat] += expenses[i].amt;
            expenses.splice(i, 1);
            updateUI(); updateHistory();
        }
    }

    function updateUI() {
        document.getElementById('needs-val').innerText = `$${Math.round(budget.needs)}`;
        document.getElementById('wants-val').innerText = `$${Math.round(budget.wants)}`;
        document.getElementById('future-val').innerText = `$${Math.round(budget.future)}`;
        document.getElementById('total-val').innerText = `$${Math.round(budget.needs + budget.wants + budget.future)}`;
    }

    function updateHistory() {
        const list = document.getElementById('history-list');
        list.innerHTML = expenses.map(e => `
            <div class="history-item">
                <div>
                    <div class="history-desc">${e.desc}</div>
                    <div class="history-meta">${e.date} ‚Ä¢ -$${e.amt.toFixed(2)}</div>
                </div>
                <button class="delete-btn" onclick="deleteExpense(${e.id})">${trans[currentLang].del}</button>
            </div>
        `).join('');
    }

    function showReportUI() {
        document.getElementById('action-ui').style.display = 'none';
        document.getElementById('report-ui').style.display = 'block';
    }

    async function generatePDF() {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        const totals = { n: expenses.filter(e=>e.cat==='needs').reduce((s,e)=>s+e.amt,0), w: expenses.filter(e=>e.cat==='wants').reduce((s,e)=>s+e.amt,0), f: expenses.filter(e=>e.cat==='future').reduce((s,e)=>s+e.amt,0) };
        const canvas = document.getElementById('chartCanvas');
        const ctx = canvas.getContext('2d');
        const myChart = new Chart(ctx, { type: 'doughnut', data: { labels: ['Needs', 'Wants', 'Future'], datasets: [{ data: [totals.n, totals.w, totals.f], backgroundColor: ['#3498db', '#f1c40f', '#2ecc71'] }] }, options: { animation: false, responsive: false } });
        await new Promise(r => setTimeout(r, 600));
        doc.setFontSize(20); doc.text("Archaigel Penny AI Report", 14, 20);
        doc.addImage(canvas.toDataURL('image/png'), 'PNG', 70, 40, 60, 60);
        doc.autoTable({ startY: 110, head: [['Date', 'Desc', 'Cat', 'Amt']], body: expenses.map(e => [e.date, e.desc, e.cat, `$${e.amt.toFixed(2)}`]) });
        doc.text(`Monthly Income: $${budget.totalIncome.toFixed(2)}`, 14, doc.lastAutoTable.finalY + 10);
        doc.text(`Architect: Archaigel`, 14, doc.lastAutoTable.finalY + 20);
        doc.save("Penny_Report_Archaigel.pdf");
        myChart.destroy();
    }
</script>
</body>
</html>
